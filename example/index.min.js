function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(){void 0!==window._sp_&&console.error("_sp_ - object undefined");var e=null,t="0.0.1",n="es3",o=C("consentUUID"),r=C("authId"),a=null,s=Math.floor(1e6*Math.random()),c=(_sp_.config.baseEndpoint,_sp_.config.baseEndpoint),p=_sp_.config.propertyHref,i=_sp_.config.propertyId,d=_sp_.config.accountId,u=!1,l=(C("consentDate"),JSON.parse(decodeURIComponent(C("consentStatus")))),g=JSON.parse(decodeURIComponent(C("localState"))),f=JSON.parse(decodeURIComponent(C("metaData"))),y=JSON.parse(decodeURIComponent(C("vendorGrants"))),S=(e=JSON.parse(decodeURIComponent(C("nonKeyedLocalState"))),null),m=null,v=_sp_.config.messageDiv,h=_sp_.config.pmDiv,I=null;g=null;null==o&&(b("consentUUID",o=T(),365),console.log("consentUUID: "+o+" generated and stored")),null==r&&(b("authId",r=T(),365),console.log("authId: "+r+" generated and stored")),window.JSON||(window.JSON={stringify:function(e){var t=_typeof(e);if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,o,r=[],a=e&&e.constructor==Array;for(n in e)"string"==(t=_typeof(o=e[n]))?o='"'+o+'"':"object"==t&&null!==o&&(o=JSON.stringify(o)),r.push((a?"":'"'+n+'":')+String(o));return(a?"[":"{")+String(r)+(a?"]":"}")}}),"function"!=typeof JSON.parse&&(JSON.parse=function(e){try{return new Function("return "+e)()}catch(e){throw new SyntaxError("JSON.parse: ung√ºltiges JSON-Format")}}),window._sp_.config.events=window._sp_.config.events||{};var _,R,O=function(e,t){var n=window._sp_.config.events[e];"function"==typeof n?n.apply(null,t||[]):console.log("No callback defined for event: "+e)};function w(){O("onConsentReady",[o,a,y])}function N(e){var t=document.getElementById(e);t&&(t.style.display="block")}function D(e){var t=document.getElementById(e);t&&(t.style.display="none")}function J(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText}function C(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].trim();if(0===o.indexOf(e+"="))return o.substring((e+"=").length,o.length)}return null}function U(e,t){var n=e+"?",o=[];for(var r in t)t.hasOwnProperty(r)&&o.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return n+o.join("&")}function T(){for(var e,t="0123456789abcdef".split(""),n=[],o=Math.random,r=0;r<36;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(e=0|16*o(),n[r]=t[19===r?3&e|8:e]);return n.join("")}function b(e,t,n){var o="";if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),o="; expires="+r.toUTCString()}document.cookie=e+"="+encodeURIComponent(t)+o+"; path=/"}function q(){console.log("getMessages()");var o=c+"/wrapper/v2/messages",a={accountId:d,campaignEnv:"prod",campaigns:{gdpr:{consentStatus:l,hasLocalData:u,targetingParams:{}}},clientMMSOrigin:c,hasCSP:!0,includeData:{localState:{type:"string"},actions:{type:"RecordString"},cookies:{type:"RecordString"}},propertyHref:_sp_.config.propertyHref,propertyId:_sp_.config.propertyId,authId:r},f=encodeURIComponent(JSON.stringify(a)),y=encodeURIComponent('{"gdpr":{"applies":true}}'),S=o+"?hasCsp=true&env=prod&body="+f+"&localState="+g+"&metadata="+y+"&nonKeyedLocalState="+e+"&ch="+s+"&scriptVersion="+t+"&scriptType="+n,m=JSON.parse(J(S));g=m.localState,b("localState",JSON.stringify(m.localState),365),e=m.nonKeyedLocalState,b("nonKeyedLocalState",JSON.stringify(m.nonKeyedLocalState),365),function(e){if(e.campaigns&&Array.isArray(e.campaigns))for(var t=0;t<e.campaigns.length;t++){var n=e.campaigns[t];if(n.message&&n.message.message_json)return I=n.messageMetaData.messageId,console.log("Show Message with id "+I),n.message.message_json}return w(),console.info("no message in the api response"),!1}(m)&&(!function(e){var t=document.getElementById(_sp_.config.qrUrl);if(t){var n=(new Date).getTime(),o=-1===e.indexOf("?")?"?":"&";t.src=e+o+"t="+n}}(_sp_.config.qrUrl+_sp_.config.pmUrl+"?authId="+r+"&propertyId="+i+"&propertyHref="+p+"&accountId="+d),N(v))}function M(e,t,n,r,s){console.log("storeConsentResponse:",e,t,n,r),l=e,b("consentStatus",JSON.stringify(e),365),o=t,b("consentUUID",t,365),consentDate=n,b("consentDate",n,365),a=r,b("euconsent-v2",r),b("vendorGrants",JSON.stringify(s),365),y=s,w()}function H(){console.log("getConsentStatus() executed");var o={hasCsp:"true",accountId:d,env:"prod",localState:JSON.stringify(g),nonKeyedLocalState:JSON.stringify(e),metadata:JSON.stringify(f),propertyId:i,withSiteActions:"true",authId:r,ch:s,scriptVersion:t,scriptType:n},a=JSON.parse(J(U("https://cmp.tcfv2.de/wrapper/v2/consent-status",o)));u=!0,M(a.consentStatusData.gdpr.consentStatus,a.consentStatusData.gdpr.consentUUID,a.consentStatusData.gdpr.dateCreated,a.consentStatusData.gdpr.euconsent,a.consentStatusData.gdpr.grants)}_sp_.executeMessaging=function(){D(h),D(v),H(),q(),console.log("Messaging executed!")},_sp_.loadPrivacyManagerModal=function(){N(h),D(v),console.log("Privacy Manager Modal loaded!")},_sp_.acceptAll=function(){D(h),D(v),function(){var e=_sp_.config.baseEndpoint+"/wrapper/v2/choice/consent-all",p={hasCsp:"true",authId:r,accountId:d,env:"prod",includeCustomVendorsRes:"true",metadata:JSON.stringify(f),propertyId:i,withSiteActions:"true",ch:s,scriptVersion:t,scriptType:n},u=[];for(var g in p)p.hasOwnProperty(g)&&u.push(encodeURIComponent(g)+"="+encodeURIComponent(p[g]));var y=J(e+"?"+u.join("&"));(function(e){e.gdpr.consentStatus.granularStatus,S=e.gdpr.consentAllRef,m=e.gdpr.gdprApplies,a=e.gdpr.euconsent;var p=c+"/wrapper/v2/choice/gdpr/11?hasCsp=true&env=prod&ch="+s+"&scriptVersion="+t+"&scriptType="+n,u=new XMLHttpRequest;u.open("POST",p,!1),u.setRequestHeader("accept","*/*"),u.setRequestHeader("accept-language","de,en;q=0.9"),u.setRequestHeader("content-type","application/json");var g={accountId:d,applies:m,authId:r,messageId:I,mmsDomain:c,propertyId:i,pubData:{},includeData:{actions:{type:"RecordString"},customVendorsResponse:{type:"RecordString"}},uuid:o,sampleRate:1,sendPVData:!1,consentAllRef:S,granularStatus:l,vendorListId:e.gdpr.vendorListId},f=JSON.stringify(g);u.onreadystatechange=function(){if(4===u.readyState&&200===u.status){var t=JSON.parse(u.responseText);M(e.gdpr.consentStatus,t.uuid,t.consentDate,a,e.gdpr.grants)}else console.error("error:",u.responseText)},u.send(f)})(JSON.parse(y)),D(v)}()},_sp_.continue=function(){var e;D(h),D(v),e=c+"/consent/tcfv2/consent/v3/"+i+"/li-only",function(e){var a=new XMLHttpRequest;console.log(e);var p=c+"/wrapper/v2/choice/gdpr/1?hasCsp=true&env=prod&ch="+s+"&scriptVersion="+t+"&scriptType="+n;a.open("POST",p,!1),a.setRequestHeader("accept","*/*"),a.setRequestHeader("accept-language","de,en;q=0.9"),a.setRequestHeader("content-type","application/json");var u={accountId:d,applies:m,authId:r,messageId:I,mmsDomain:c,propertyId:i,pubData:{},includeData:{actions:{type:"RecordString"},customVendorsResponse:{type:"RecordString"}},uuid:o,sampleRate:1,sendPVData:!1,pmSaveAndExitVariables:e};a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var e=JSON.parse(a.responseText);M(e.consentStatus,e.uuid,e.dateCreated,e.euconsent,e.grants)}else console.error("error:",a.responseText)},a.send(JSON.stringify(u))}(JSON.parse(J(e)))},_sp_.reject=function(){D(h),D(v),function(){var e=c+"/wrapper/v2/choice/reject-all",a={hasCsp:"true",authId:r,accountId:d,env:"prod",includeCustomVendorsRes:"true",metadata:JSON.stringify(f),propertyId:i,withSiteActions:"true",ch:s,scriptVersion:t,scriptType:n},p=[];for(var u in a)a.hasOwnProperty(u)&&p.push(encodeURIComponent(u)+"="+encodeURIComponent(a[u]));var l=J(e+"?"+p.join("&"));(function(e){e.gdpr.consentStatus.granularStatus,S=e.gdpr.consentAllRef,m=e.gdpr.gdprApplies;var a=c+"/wrapper/v2/choice/gdpr/13?hasCsp=true&env=prod&ch="+s+"&scriptVersion="+t+"&scriptType="+n,p=new XMLHttpRequest;p.open("POST",a,!1),p.setRequestHeader("accept","*/*"),p.setRequestHeader("accept-language","de,en;q=0.9"),p.setRequestHeader("content-type","application/json");var u={accountId:d,applies:m,authId:r,messageId:I,mmsDomain:c,propertyId:i,pubData:{},includeData:{actions:{type:"RecordString"},customVendorsResponse:{type:"RecordString"}},uuid:o,sampleRate:1,sendPVData:!0},l=JSON.stringify(u);p.onreadystatechange=function(){if(4===p.readyState&&200===p.status){var e=JSON.parse(p.responseText);M(e.consentStatus,e.uuid,e.dateCreated,e.euconsent,e.grants)}else console.error("error:",p.responseText)},p.send(l)})(JSON.parse(l)),D(v)}()},_={hasCsp:"true",accountId:d,env:"prod",metadata:'{"gdpr":{}}',propertyId:i,scriptVersion:t,scriptType:n},R=JSON.parse(J(U("https://cmp.tcfv2.de/wrapper/v2/meta-data",_))),f=R,b("metaData",JSON.stringify(f),365),H(),q()}();